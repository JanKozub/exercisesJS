<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>zad1</title>

    <script>
        let input = prompt("podaj dna");

        document.write(input)

        makeSpace()
        input = input.toUpperCase();

        const sliced = [];
        const komp = [];

        sliceInput();

        printSliced();
        makeSpace();

        printComplementarity();
        makeSpace()

        complementarityConvert();
        makeSpace();

        const sortedMap = mapSlicedAndSort();

        printSorted();

        function makeSpace() {
            document.write("<br>")
            document.write("<br>")
        }

        function sliceInput() {
            for (let i = 3; i < input.length; i += 3) {
                let gen = input.slice((i - 3), i)
                sliced.push(gen)

                komp.push(complementarityReplace(gen))
            }
        }

        function printSliced() {
            for (let k = 0; k < sliced.length; k++) {
                if (sliced[k] === "TAA" || sliced[k] === "TAG" || sliced[k] === "TGA") {
                    document.write("<span style='background: yellow'>" + sliced[k] + "</span>");
                } else if (sliced[k] === "ATG") {
                    document.write("<span style='color: green'>" + sliced[k] + "</span>");
                } else {
                    document.write("<span>" + sliced[k] + "</span>");
                }
                document.write("<span>&nbsp;</span>")
            }
        }

        function complementarityReplace(gen) {
            let result = "";
            for (let t = 0; t < 3; t++) {
                switch (gen.charAt(t)) {
                    case 'T':
                        result = result + "A"
                        break;
                    case 'A':
                        result = result + "T"
                        break;
                    case 'C':
                        result = result + "G"
                        break;
                    case 'G':
                        result = result + "C"
                        break;
                }
            }
            return result;
        }

        function printComplementarity() {
            for (let h = 0; h < komp.length; h++) {
                document.write(komp[h])
                document.write("<span>&nbsp;</span>")
            }
        }

        function complementarityConvert() {
            let complementarityString = ""
            for (let p = 0; p < komp.length; p++) {
                complementarityString = complementarityString + komp[p].toLowerCase()
            }
            document.write(complementarityString)
        }

        function genRandomColor() {
            return "#" + Math.floor(Math.random() * 16777215).toString(16);
        }

        function mapSlicedAndSort() {
            const map = new Map();
            for (let o = 0; o < sliced.length; o++) {
                let tester = sliced[o]
                let counter = 0;
                for (let i = 0; i < sliced.length; i++) {
                    if (sliced[i] === tester) {
                        counter++
                    }
                }
                map.set(tester, counter)
            }

            return new Map([...map.entries()].sort((a, b) => b[1] - a[1]));
        }

        function printSorted() {
            let color = ""
            for (let l = 0; l < sortedMap.size; l++) {

                if (l % 5 === 0) {
                    color = genRandomColor()
                }

                let name = Array.from(sortedMap.keys())[l]
                let val = Array.from(sortedMap.entries())[l].toString()
                val = val.substring(4, val.length)

                document.write(`<span style='background-color: ${color}'>${name} - ${val}</span>`)
                document.write("<br>")
            }
        }
    </script>
</head>
<body>

</body>
</html>
